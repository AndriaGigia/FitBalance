<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>FitBalance ‚Äî Meal Variants</title>
<style>
  *{margin:0;padding:0;box-sizing:border-box}
  body{font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px}
  .container{max-width:980px;margin:0 auto}
  header{text-align:center;color:#fff;margin-bottom:36px}
  header h1{font-size:2.6rem;margin-bottom:6px;text-shadow:2px 2px 6px rgba(0,0,0,.25)}
  .card{background:#fff;border-radius:20px;padding:32px;margin-bottom:22px;box-shadow:0 10px 28px rgba(0,0,0,.22)}
  h2{color:#667eea;margin-bottom:18px}
  .form-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:14px;margin-bottom:10px}
  label{color:#444;margin-bottom:6px;font-weight:600;display:block}
  input,select{padding:12px;border:2px solid #e5e7eb;border-radius:10px;font-size:1rem;transition:.2s background,border,transform}
  input:focus,select:focus{outline:none;border-color:#667eea;transform:translateY(-2px);box-shadow:0 6px 16px rgba(102,126,234,.25)}
  .btn{display:inline-block;width:100%;margin-top:10px;border:none;border-radius:12px;padding:14px 18px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;font-weight:700;cursor:pointer;transition:.2s transform,box-shadow}
  .btn:hover{transform:translateY(-3px);box-shadow:0 10px 24px rgba(102,126,234,.45)}
  .results{display:none}
  .results.show{display:block;animation:fadeInUp .45s ease-out}
  .result-box{background:linear-gradient(135deg,#f5f7fa 0%,#c3cfe2 100%);padding:18px 20px;border-radius:14px;margin-bottom:16px}
  .result-item{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #e5e7eb}
  .result-item:last-child{border-bottom:none}
  .result-label{color:#555;font-weight:600}
  .result-value{color:#667eea;font-weight:800}
  .meal-plan{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px;margin-top:10px}
  .meal-card{background:#fff;border:1px solid #edf2f7;border-radius:16px;padding:18px;border-left:5px solid #667eea;box-shadow:0 4px 12px rgba(0,0,0,.08);cursor:pointer;transition:.2s transform,box-shadow}
  .meal-card:hover{transform:translateY(-4px);box-shadow:0 10px 22px rgba(0,0,0,.12)}
  .meal-card h3{color:#667eea;margin-bottom:10px;font-size:1.15rem;display:flex;align-items:center;gap:8px}
  .meal-card ul{list-style:none}
  .meal-card li{position:relative;padding-left:18px;color:#5b5b5b;padding:6px 0}
  .meal-card li::before{content:"‚úì";position:absolute;left:0;top:0;color:#10b981;font-weight:900}
  .calories-badge{display:inline-block;margin-top:8px;background:#10b981;color:#fff;border-radius:999px;padding:4px 10px;font-size:.9rem}
  .hint{color:#6b7280;margin:8px 0 4px}
  .error{display:none;margin-top:8px;background:#fde8e8;color:#b91c1c;border:1px solid #fecaca;border-radius:10px;padding:10px 12px}
  .error.show{display:block}
  /* Modal */
  .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;align-items:center;justify-content:center;padding:16px}
  .modal-backdrop.show{display:flex}
  .modal{background:#fff;border-radius:16px;max-width:680px;width:100%;box-shadow:0 18px 38px rgba(0,0,0,.28);animation:pop .18s ease-out}
  .modal header{color:#1f2937;text-align:left;padding:18px 22px;border-bottom:1px solid #eef2f7}
  .modal header h3{font-size:1.2rem}
  .modal .content{padding:14px 20px 20px}
  .variant{border:1px solid #e5e7eb;border-radius:12px;padding:14px 14px;margin-bottom:12px;display:flex;gap:12px;align-items:flex-start}
  .variant .tag{font-weight:700;color:#374151;background:#e5e7eb;border-radius:8px;padding:2px 8px}
  .variant ul{list-style:none;margin-top:6px}
  .variant li{padding:4px 0;color:#4b5563}
  .variant .meta{display:flex;gap:8px;align-items:center;margin-top:6px}
  .variant .cal{background:#10b981;color:#fff;border-radius:999px;padding:3px 8px;font-size:.85rem}
  .modal .actions{display:flex;justify-content:flex-end;gap:8px;padding:0 20px 16px}
  .btn-sm{padding:10px 14px;border:none;border-radius:10px;background:#667eea;color:#fff;font-weight:700;cursor:pointer}
  .btn-outline{background:#fff;color:#374151;border:1px solid #e5e7eb}
  @keyframes fadeInUp{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:translateY(0)}}
  @keyframes pop{from{transform:scale(.97);opacity:.7}to{transform:scale(1);opacity:1}}
  @media (max-width:600px){header h1{font-size:2rem}.card{padding:22px}}
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>üéØ FitBalance</h1>
    <p>Your personalized weight loss journey starts here</p>
  </header>

  <div class="card">
    <h2>üìä Calculate Your Daily Calories</h2>
    <div id="err" class="error"></div>
    <form id="form" novalidate>
      <div class="form-grid">
        <div><label for="age">Age</label><input id="age" type="number" min="15" max="100" placeholder="e.g., 30" required></div>
        <div><label for="gender">Gender</label>
          <select id="gender" required>
            <option value="">Select...</option>
            <option value="male">Male</option>
            <option value="female">Female</option>
          </select></div>
        <div><label for="height">Height (cm)</label><input id="height" type="number" min="100" max="250" placeholder="e.g., 170" required></div>
        <div><label for="weight">Current Weight (kg)</label><input id="weight" type="number" min="30" max="300" step="0.1" placeholder="e.g., 75" required></div>
        <div><label for="target">Target Weight (kg)</label><input id="target" type="number" min="30" max="300" step="0.1" placeholder="e.g., 65" required></div>
        <div><label for="activity">Activity Level</label>
          <select id="activity" required>
            <option value="">Select...</option>
            <option value="1.2">Sedentary (little or no exercise)</option>
            <option value="1.375">Lightly active (1‚Äì3 days/week)</option>
            <option value="1.55">Moderately active (3‚Äì5 days/week)</option>
            <option value="1.725">Very active (6‚Äì7 days/week)</option>
            <option value="1.9">Super active (athlete)</option>
          </select>
        </div>
      </div>
      <button class="btn" type="submit">Calculate / Update Plan</button>
      <p class="hint">–ü–æ—Å–ª–µ —Ä–∞—Å—á—ë—Ç–∞ –∫–ª–∏–∫–∞–π –ø–æ –ª—é–±–æ–º—É –±–ª–æ–∫—É (Breakfast/Lunch/Dinner/Snacks), —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å –æ–¥–∏–Ω –∏–∑ 3 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Å –ø–æ—Ö–æ–∂–µ–π –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å—é.</p>
    </form>
  </div>

  <div id="results" class="results">
    <div class="card">
      <h2>üéâ Your Personalized Plan</h2>
      <div class="result-box">
        <div class="result-item"><span class="result-label">BMR</span><span id="bmr" class="result-value">-</span></div>
        <div class="result-item"><span class="result-label">TDEE</span><span id="tdee" class="result-value">-</span></div>
        <div class="result-item"><span class="result-label">Calories for Weight Loss</span><span id="cals" class="result-value">-</span></div>
        <div class="result-item"><span class="result-label">Weight to Lose</span><span id="tolose" class="result-value">-</span></div>
        <div class="result-item"><span class="result-label">Estimated Time</span><span id="time" class="result-value">-</span></div>
      </div>
    </div>

    <div class="card">
      <h2>üçΩÔ∏è Sample Meal Plan</h2>
      <div id="meals" class="meal-plan"></div>
    </div>
  </div>
</div>

<!-- Modal -->
<div id="backdrop" class="modal-backdrop" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <header><h3 id="modalTitle">Choose a variant</h3></header>
    <div class="content" id="modalContent"></div>
    <div class="actions">
      <button class="btn-sm btn-outline" id="closeModal">Close</button>
    </div>
  </div>
</div>

<script>
// ---------- Data ----------
// Base meal variants per calorie plan and meal type.
// Each variant has: items[], approx calories (cal), and a short tag.
const variants = {
  1200: {
    breakfast: [
      { tag:'Option A', cal: 360, items:['2 eggs','Whole wheat toast','Small avocado','Black coffee'] },
      { tag:'Option B', cal: 350, items:['Oatmeal (40g) with berries','Low-fat yogurt','Green tea'] },
      { tag:'Option C', cal: 370, items:['Greek yogurt (150g)','Granola (30g)','Banana','Espresso'] }
    ],
    lunch: [
      { tag:'Option A', cal: 420, items:['Grilled chicken (150g)','Mixed salad','Olive oil (1 tsp)','Apple'] },
      { tag:'Option B', cal: 410, items:['Tuna salad','Whole grain crackers (4 pcs)','Pear'] },
      { tag:'Option C', cal: 430, items:['Turkey wrap','Veggie sticks','Hummus (2 tbsp)'] }
    ],
    dinner: [
      { tag:'Option A', cal: 360, items:['Baked salmon (150g)','Steamed broccoli','Quinoa (80‚Äì100g cooked)','Lemon'] },
      { tag:'Option B', cal: 350, items:['Stir-fry tofu (120g)','Mixed veggies','Brown rice (100g cooked)'] },
      { tag:'Option C', cal: 370, items:['Lean beef (120g)','Cauliflower mash','Green beans'] }
    ],
    snacks: [
      { tag:'Option A', cal: 60, items:['Handful of almonds (10‚Äì12)'] },
      { tag:'Option B', cal: 70, items:['Apple','Peanut butter (1 tsp)'] },
      { tag:'Option C', cal: 65, items:['Cottage cheese (80g)'] }
    ]
  },
  1500: {
    breakfast: [
      { tag:'Option A', cal: 450, items:['3 eggs scrambled','Whole wheat toast','Half avocado','Orange juice (150ml)'] },
      { tag:'Option B', cal: 460, items:['Oatmeal (50g) + banana','Almonds (15g)','Coffee'] },
      { tag:'Option C', cal: 440, items:['Protein smoothie','Peanut butter toast','Strawberries'] }
    ],
    lunch: [
      { tag:'Option A', cal: 525, items:['Chicken breast (180g)','Mixed vegetables','Brown rice (150g cooked)','Banana'] },
      { tag:'Option B', cal: 510, items:['Turkey sandwich','Side salad','Olive oil (1 tsp)'] },
      { tag:'Option C', cal: 530, items:['Beef chili (200g)','Baked potato (150g)','Greek yogurt (plain)'] }
    ],
    dinner: [
      { tag:'Option A', cal: 450, items:['Lean beef steak (180g)','Sweet potato','Green beans','Side salad'] },
      { tag:'Option B', cal: 460, items:['Grilled salmon (170g)','Quinoa (120g cooked)','Roasted vegetables'] },
      { tag:'Option C', cal: 440, items:['Chicken stir-fry','Buckwheat (120g cooked)','Cucumber salad'] }
    ],
    snacks: [
      { tag:'Option A', cal: 75, items:['Protein shake (small)'] },
      { tag:'Option B', cal: 80, items:['Apple','Peanut butter (1 tsp)'] },
      { tag:'Option C', cal: 70, items:['Dark chocolate (2‚Äì3 squares)'] }
    ]
  },
  1800: {
    breakfast: [
      { tag:'Option A', cal: 540, items:['Oatmeal with berries','3 eggs','Whole wheat toast','Almond butter','Coffee'] },
      { tag:'Option B', cal: 530, items:['Greek yogurt bowl','Granola (40g)','Honey (1 tsp)','Banana'] },
      { tag:'Option C', cal: 550, items:['Avocado toast x2','Boiled eggs (2)','Orange'] }
    ],
    lunch: [
      { tag:'Option A', cal: 630, items:['Turkey sandwich (big)','Sweet potato','Greek salad','Orange'] },
      { tag:'Option B', cal: 620, items:['Chicken burrito bowl','Brown rice (160g)','Pico + beans'] },
      { tag:'Option C', cal: 640, items:['Pasta + tuna (160g cooked)','Olive oil (1 tbsp)','Side salad'] }
    ],
    dinner: [
      { tag:'Option A', cal: 540, items:['Grilled salmon (200g)','Quinoa (150g cooked)','Roasted vegetables','Side salad'] },
      { tag:'Option B', cal: 550, items:['Beef steak (200g)','Baked potato','Broccoli'] },
      { tag:'Option C', cal: 530, items:['Chicken curry (200g)','Basmati rice (150g cooked)','Cucumber salad'] }
    ],
    snacks: [
      { tag:'Option A', cal: 90, items:['Protein bar (small)'] },
      { tag:'Option B', cal: 85, items:['Mixed nuts (20g)'] },
      { tag:'Option C', cal: 95, items:['Greek yogurt (150g) + honey (1 tsp)'] }
    ]
  },
  2000: {
    breakfast: [
      { tag:'Option A', cal: 600, items:['4 eggs','Oatmeal + banana','Whole wheat toast','Peanut butter','OJ (200ml)'] },
      { tag:'Option B', cal: 590, items:['Pancakes (2) + maple (1 tbsp)','Scrambled eggs (2)','Blueberries'] },
      { tag:'Option C', cal: 610, items:['Breakfast burrito','Salsa','Orange'] }
    ],
    lunch: [
      { tag:'Option A', cal: 700, items:['Chicken breast (200g)','Brown rice (200g cooked)','Mixed vegetables','Fruit salad'] },
      { tag:'Option B', cal: 690, items:['Beef bowl','Quinoa (170g cooked)','Roasted peppers','Avocado (1/2)'] },
      { tag:'Option C', cal: 710, items:['Whole grain pasta (180g cooked)','Turkey meatballs','Tomato sauce','Parmesan (small)'] }
    ],
    dinner: [
      { tag:'Option A', cal: 600, items:['Lean beef (200g)','Sweet potato','Broccoli','Quinoa','Large salad'] },
      { tag:'Option B', cal: 590, items:['Grilled salmon (220g)','Brown rice (180g cooked)','Asparagus','Olive oil (1 tbsp)'] },
      { tag:'Option C', cal: 610, items:['Chicken fajitas','Tortillas (2)','Guacamole (2 tbsp)','Veggies'] }
    ],
    snacks: [
      { tag:'Option A', cal: 100, items:['Protein shake','Walnuts (small)'] },
      { tag:'Option B', cal: 95, items:['Trail mix (25g)'] },
      { tag:'Option C', cal: 105, items:['Cottage cheese (150g)'] }
    ]
  }
};

// Split of calories across meals
const split = { breakfast:0.30, lunch:0.35, dinner:0.30, snacks:0.05 };

// ---------- Helpers ----------
const $ = (id) => document.getElementById(id);
const round = (n) => Math.round(n);

function nearestPlanCalories(target){
  const choices = [1200,1500,1800,2000];
  return choices.reduce((best,c)=>Math.abs(c-target)<Math.abs(best-target)?c:best, choices[0]);
}

function weeksOrMonths(weeks){
  const m = Math.ceil(weeks/4);
  return m < 2 ? `${weeks} weeks` : `${m} months`;
}

function showError(msgs){
  const e = $('err');
  e.innerHTML = (Array.isArray(msgs)?msgs:[msgs]).map(m=>'‚Ä¢ '+m).join('<br>');
  e.classList.add('show');
}
function clearError(){ $('err').classList.remove('show'); $('err').innerHTML=''; }

// ---------- Core Calc ----------
function calcAndRender(){
  clearError();
  const age = parseInt($('age').value);
  const gender = $('gender').value;
  const height = parseInt($('height').value);
  const weight = parseFloat($('weight').value);
  const target = parseFloat($('target').value);
  const activity = parseFloat($('activity').value);

  const errs = [];
  if(!age || age<15 || age>100) errs.push('Enter age 15‚Äì100');
  if(!gender) errs.push('Select gender');
  if(!height || height<100 || height>250) errs.push('Height must be 100‚Äì250 cm');
  if(!weight || weight<30 || weight>300) errs.push('Weight must be 30‚Äì300 kg');
  if(!target || target<30 || target>300) errs.push('Target must be 30‚Äì300 kg');
  if(!activity) errs.push('Select activity');
  if(!isNaN(weight) && !isNaN(target) && target >= weight) errs.push('Target must be less than current weight');
  if(errs.length){ showError(errs); return; }

  const bmr = gender==='male'
    ? 10*weight + 6.25*height - 5*age + 5
    : 10*weight + 6.25*height - 5*age - 161;

  const tdee = bmr * activity;
  const chosenDeficit = Math.min(500, tdee*0.20);
  const targetCalories = Math.max(1200, Math.round(tdee - chosenDeficit)); // keep >=1200
  const weightToLose = weight - target;
  const weeks = Math.ceil(weightToLose / 0.5);

  $('bmr').textContent = `${round(bmr)} kcal/day`;
  $('tdee').textContent = `${round(tdee)} kcal/day`;
  $('cals').textContent = `${targetCalories} kcal/day`;
  $('tolose').textContent = `${weightToLose.toFixed(1)} kg`;
  $('time').textContent = weeksOrMonths(weeks);

  const plan = nearestPlanCalories(targetCalories);
  renderMeals(plan, targetCalories);

  $('results').classList.add('show');
  $('results').scrollIntoView({behavior:'smooth'});
}

// ---------- Meals Render & Interaction ----------
function renderMeals(planCalories, targetCalories){
  const container = $('meals');
  container.innerHTML = '';

  // Preselect first option for each meal type based on split
  const mealTypes = ['breakfast','lunch','dinner','snacks'];
  mealTypes.forEach(type => {
    const goal = Math.round(targetCalories * split[type]);
    const opts = variants[planCalories][type];

    // choose the variant with calories closest to goal
    const startIndex = opts.reduce((bestIdx, v, i) =>
      Math.abs(v.cal - goal) < Math.abs(opts[bestIdx].cal - goal) ? i : bestIdx, 0);
    const v = opts[startIndex];

    const card = document.createElement('div');
    card.className = 'meal-card';
    card.dataset.type = type;
    card.dataset.plan = planCalories;

    card.innerHTML = `
      <h3>${typeIcon(type)} ${capitalize(type)}</h3>
      <ul>${v.items.map(x=>`<li>${x}</li>`).join('')}</ul>
      <span class="calories-badge" data-cal>~${v.cal} kcal</span>
    `;

    card.addEventListener('click', () => openModal(type, planCalories, goal, card));
    container.appendChild(card);
  });
}

function typeIcon(type){
  return {
    breakfast:'üåÖ', lunch:'‚òÄÔ∏è', dinner:'üåô', snacks:'üçé'
  }[type] || 'üçΩÔ∏è';
}

function capitalize(s){ return s.charAt(0).toUpperCase() + s.slice(1); }

// ---------- Modal ----------
const backdrop = $('backdrop');
const modalContent = $('modalContent');
const modalTitle = $('modalTitle');
$('closeModal').addEventListener('click', () => backdrop.classList.remove('show'));
backdrop.addEventListener('click', (e)=>{ if(e.target===backdrop) backdrop.classList.remove('show'); });

function openModal(type, planCalories, goal, targetCard){
  modalTitle.textContent = `${capitalize(type)} ‚Äî choose one`;
  const list = variants[planCalories][type];
  modalContent.innerHTML = '';

  list.forEach((opt, idx) => {
    const wrap = document.createElement('div');
    wrap.className = 'variant';
    wrap.innerHTML = `
      <div class="tag">${opt.tag}</div>
      <div style="flex:1">
        <ul>${opt.items.map(x=>`<li>${x}</li>`).join('')}</ul>
        <div class="meta">
          <span class="cal">~${opt.cal} kcal</span>
          <span style="color:#6b7280">(${diffText(opt.cal, goal)})</span>
        </div>
      </div>
      <div>
        <button class="btn-sm">Select</button>
      </div>
    `;
    wrap.querySelector('.btn-sm').addEventListener('click', ()=>{
      // Replace items in target card
      targetCard.querySelector('ul').innerHTML = opt.items.map(x=>`<li>${x}</li>`).join('');
      targetCard.querySelector('[data-cal]').textContent = `~${opt.cal} kcal`;
      backdrop.classList.remove('show');
    });
    modalContent.appendChild(wrap);
  });

  backdrop.classList.add('show');
}

function diffText(cal, goal){
  const d = cal - goal;
  if (Math.abs(d) <= 40) return '‚âà target';
  return d>0 ? `+${d} vs target` : `${d} vs target`;
}

// ---------- Events ----------
document.getElementById('form').addEventListener('submit', (e)=>{
  e.preventDefault();
  calcAndRender();
});

// live updates if results already shown
['age','gender','height','weight','target','activity'].forEach(id=>{
  document.getElementById(id).addEventListener('input', debounce(()=>{
    if(document.querySelector('.results.show')) calcAndRender();
  }, 450));
});

function debounce(fn, ms){ let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn(...a), ms); }; }
</script>
</body>
</html>
